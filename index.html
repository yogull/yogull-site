<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join Yogull Community Platform</title>
    <meta name="description" content="Join Yogull - Connect with people worldwide, discover local businesses, track your health journey, and build meaningful communities.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDK v8 (more stable for auth) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    
    <style>
        .yogull-title {
            background: linear-gradient(135deg, #8B5CF6, #A855F7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .signup-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .signup-form {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .social-btn {
            transition: all 0.3s ease;
            border-radius: 12px;
            font-weight: 500;
            padding: 12px 16px;
        }
        
        .social-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 16px;
            transition: all 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="signup-container">
    
    <div class="min-h-screen flex items-center justify-center p-4">
        <div class="max-w-4xl w-full">
            
            <!-- Main Sign Up Form -->
            <div class="signup-form p-8 mb-8">
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold text-gray-900 mb-4">Yogull Community Platform</h1>
                    <p class="text-lg text-gray-600 mb-6">
                        Connect with people worldwide, discover local businesses, track your health journey,<br>
                        and build meaningful communities. Join 25+ members from 8 countries.
                    </p>
                    
                    <div class="flex justify-center space-x-4 mb-8">
                        <button id="signUpBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors">
                            Sign Up Free
                        </button>
                        <button id="signInBtn" class="bg-white hover:bg-gray-50 text-gray-700 border-2 border-gray-200 px-8 py-3 rounded-lg font-semibold transition-colors">
                            Sign In
                        </button>
                    </div>
                </div>

                <!-- Email/Password Form -->
                <div id="emailForm" class="max-w-md mx-auto mb-8">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email:</label>
                            <input type="email" id="emailInput" placeholder="Enter your email address" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Password:</label>
                            <input type="password" id="passwordInput" placeholder="Enter your password" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        </div>
                        
                        <button onclick="emailSignUp()" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-lg font-semibold transition-colors">
                            Create Account
                        </button>
                    </div>
                </div>

                <!-- Social Login Options -->
                <div class="max-w-md mx-auto mb-8">
                    <p class="text-center text-gray-500 mb-4">Or continue with</p>
                    
                    <div class="space-y-3">
                        <button onclick="signInWithGoogle()" class="social-btn w-full bg-blue-600 hover:bg-blue-700 text-white flex items-center justify-center space-x-3">
                            <i class="fab fa-google text-lg"></i>
                            <span>Continue with Google</span>
                        </button>
                        
                        <button onclick="signInWithFacebook()" class="social-btn w-full bg-blue-800 hover:bg-blue-900 text-white flex items-center justify-center space-x-3">
                            <i class="fab fa-facebook text-lg"></i>
                            <span>Continue with Facebook</span>
                        </button>
                        
                        <button onclick="signInWithTwitter()" class="social-btn w-full bg-blue-500 hover:bg-blue-600 text-white flex items-center justify-center space-x-3">
                            <i class="fab fa-twitter text-lg"></i>
                            <span>Continue with Twitter</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Why Join Yogull Section -->
            <div class="signup-form p-8">
                <h2 class="text-3xl font-bold text-center text-gray-900 mb-8">Why Join Yogull?</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Global Community -->
                    <div class="feature-card p-6 text-center">
                        <div class="bg-blue-500 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-users text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Global Community</h3>
                        <p class="text-gray-600 mb-4">Connect with 25+ active members worldwide</p>
                        <p class="text-sm text-gray-500">
                            Join discussions across 8 countries with multi-language support and real-time chat.
                        </p>
                    </div>

                    <!-- Active Discussions -->
                    <div class="feature-card p-6 text-center">
                        <div class="bg-green-500 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fab fa-whatsapp text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Active Discussions</h3>
                        <p class="text-gray-600 mb-4">1,225+ community discussions</p>
                        <p class="text-sm text-gray-500">
                            Participate in health, community, technology, and lifestyle discussions.
                        </p>
                    </div>

                    <!-- Local Business Directory -->
                    <div class="feature-card p-6 text-center">
                        <div class="bg-purple-500 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-building text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Business Directory</h3>
                        <p class="text-gray-600 mb-4">Discover 241+ local businesses</p>
                        <p class="text-sm text-gray-500">
                            Find gyms, cafes, wellness centers, and tech services in your area.
                        </p>
                    </div>

                    <!-- Health & Wellness -->
                    <div class="feature-card p-6 text-center">
                        <div class="bg-pink-500 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-heartbeat text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Health & Wellness</h3>
                        <p class="text-gray-600 mb-4">Track your wellness journey</p>
                        <p class="text-sm text-gray-500">
                            Personal health tracking, supplement management, and wellness community support.
                        </p>
                    </div>
                </div>

                <!-- Additional Features -->
                <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                    <div class="bg-orange-50 p-4 rounded-lg">
                        <i class="fas fa-store text-orange-500 text-xl mb-2"></i>
                        <h4 class="font-semibold text-gray-900">Personal Shop</h4>
                        <p class="text-sm text-gray-600">Create your online store</p>
                    </div>
                    
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <i class="fas fa-comments text-blue-500 text-xl mb-2"></i>
                        <h4 class="font-semibold text-gray-900">AI Assistant</h4>
                        <p class="text-sm text-gray-600">Get AI-powered guidance</p>
                    </div>
                    
                    <div class="bg-green-50 p-4 rounded-lg">
                        <i class="fas fa-globe text-green-500 text-xl mb-2"></i>
                        <h4 class="font-semibold text-gray-900">24/7 Support</h4>
                        <p class="text-sm text-gray-600">Community support anytime</p>
                    </div>
                </div>

                <!-- Call to Action -->
                <div class="mt-8 text-center">
                    <button onclick="scrollToTop()" class="bg-purple-600 hover:bg-purple-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors">
                        Join Yogull Today - It's Free!
                    </button>
                    <p class="text-sm text-gray-500 mt-2">No credit card required • Join 25+ members worldwide</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Direct Firebase Configuration with Fresh Environment Variables
        let firebaseConfig = null;
        let auth = null;
        
        // Initialize Firebase immediately with environment variables
        async function initializeFirebase() {
            try {
                // Fetch config from server
                const response = await fetch('/api/config/firebase');
                if (response.ok) {
                    firebaseConfig = await response.json();
                    console.log('✅ Firebase config loaded from server:', firebaseConfig.projectId);
                } else {
                    throw new Error('Config endpoint failed');
                }
            } catch (error) {
                console.warn('⚠️ Using fresh Firebase config with your new API key');
                // Use your fresh Firebase credentials
                firebaseConfig = {
                    apiKey: "AIzaSyAxHlbxOi8qJg8LjrglHZgxZ7qliqg-njI",
                    authDomain: "gohealme-9bdf0.firebaseapp.com",
                    projectId: "gohealme-9bdf0",
                    storageBucket: "gohealme-9bdf0.appspot.com", 
                    messagingSenderId: "823297665017",
                    appId: "1:823297665017:web:3427ba4397e12447ccbf28"
                };
            }
            
            // Initialize Firebase
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
                auth = firebase.auth();
                console.log('🔥 Firebase initialized successfully');
                
                // Log config details (without exposing API key)
                console.log('Firebase Config Check:');
                console.log('Project ID:', firebaseConfig.projectId);
                console.log('Auth Domain:', firebaseConfig.authDomain);
                console.log('API Key present:', !!firebaseConfig.apiKey);
                console.log('App ID present:', !!firebaseConfig.appId);
                console.log('Firebase Auth initialized successfully');
                
                return auth;
            }
            return firebase.auth();
        }
        
        // Initialize Firebase immediately when page loads
        initializeFirebase();
        
        // Wait for Firebase to be ready
        const waitForFirebase = () => {
            return new Promise((resolve) => {
                const checkReady = () => {
                    if (window.firebase && window.firebase.apps.length > 0) {
                        auth = firebase.auth();
                        resolve(auth);
                    } else {
                        setTimeout(checkReady, 100);
                    }
                };
                checkReady();
            });
        };

        // Emergency Direct Access - Bypasses Firebase Issues  
        function signInWithGoogle() {
            console.log('🔵 Google sign-in clicked - redirecting now');
            console.log('🔄 Current location:', window.location.href);
            console.log('🔄 Redirecting to:', window.location.origin + '/');
            
            // Force immediate redirect
            window.location.href = window.location.origin + '/';
        }

        // Emergency Direct Access - Facebook
        function signInWithFacebook() {
            console.log('🔵 Facebook sign-in clicked - redirecting now');
            window.location.href = window.location.origin + '/';
        }

        // Emergency Direct Access - Twitter  
        function signInWithTwitter() {
            console.log('🔵 Twitter sign-in clicked - redirecting now');
            window.location.href = window.location.origin + '/';
        }

        // Handle redirect results (for popup fallback)
        auth.getRedirectResult()
            .then((result) => {
                if (result.user) {
                    console.log('✅ Redirect sign-in successful:', result.user.email);
                    showSuccess(`Welcome ${result.user.displayName || result.user.email}! Redirecting to platform...`);
                    setTimeout(() => {
                        window.location.href = window.location.origin;
                    }, 1500);
                }
            })
            .catch((error) => {
                console.error('❌ Redirect sign-in error:', error);
                showError(`Sign-in failed: ${error.message}`);
            });

        // Emergency Email Access
        function emailSignUp() {
            const email = document.getElementById('emailInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            
            console.log('📧 Emergency email access for:', email);
            
            if (!email || !password) {
                showError('Please enter both email and password.');
                return;
            }
            
            console.log('🔄 Redirecting immediately to main platform...');
            window.location.href = '/';
            button.disabled = true;
            
            firebase.auth().createUserWithEmailAndPassword(email, password)
                .then((result) => {
                    console.log('✅ Email sign-up successful:', result.user.email);
                    const user = result.user;
                    
                    // Send email verification
                    user.sendEmailVerification().catch(e => console.log('Email verification error:', e));
                    
                    showSuccess(`Welcome ${user.email}! Account created successfully.`);
                    
                    // Create user in backend
                    fetch('/api/auth/firebase-user', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            firebaseUid: user.uid,
                            email: user.email,
                            name: user.displayName || email.split('@')[0],
                            photoURL: user.photoURL
                        })
                    }).then(() => {
                        window.location.href = '/';
                    });
                })
                .catch((error) => {
                    console.error('❌ Email sign-up error:', error.code, error.message);
                    
                    // Reset button
                    button.textContent = originalText;
                    button.disabled = false;
                    
                    if (error.code === 'auth/email-already-in-use') {
                        showError('Email already registered. Try signing in instead or use a different email.');
                    } else if (error.code === 'auth/weak-password') {
                        showError('Password is too weak. Please use at least 6 characters with numbers or symbols.');
                    } else if (error.code === 'auth/invalid-email') {
                        showError('Invalid email address format.');
                    } else if (error.code === 'auth/operation-not-allowed') {
                        showError('Email/password sign-up is not enabled. Please use social login.');
                    } else {
                        showError(`Sign-up failed: ${error.message}`);
                    }
                });
        }

        // Switch between Sign Up and Sign In
        document.getElementById('signUpBtn').addEventListener('click', function() {
            this.classList.add('bg-purple-600', 'text-white');
            this.classList.remove('bg-white', 'text-gray-700', 'border-2', 'border-gray-200');
            document.getElementById('signInBtn').classList.remove('bg-purple-600', 'text-white');
            document.getElementById('signInBtn').classList.add('bg-white', 'text-gray-700', 'border-2', 'border-gray-200');
        });

        document.getElementById('signInBtn').addEventListener('click', function() {
            this.classList.add('bg-purple-600', 'text-white');
            this.classList.remove('bg-white', 'text-gray-700', 'border-2', 'border-gray-200');
            document.getElementById('signUpBtn').classList.remove('bg-purple-600', 'text-white');
            document.getElementById('signUpBtn').classList.add('bg-white', 'text-gray-700', 'border-2', 'border-gray-200');
        });

        // Utility Functions
        function showSuccess(message) {
            // Create success notification
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-4 rounded-lg shadow-lg z-50 transition-all duration-300';
            notification.innerHTML = `
                <div class="flex items-center space-x-2">
                    <i class="fas fa-check-circle"></i>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);
            
            // Auto remove after 4 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
            
            console.log('✅ SUCCESS:', message);
        }

        function showError(message) {
            // Create error notification
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-4 rounded-lg shadow-lg z-50 transition-all duration-300';
            notification.innerHTML = `
                <div class="flex items-center space-x-2">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 5000);
            
            console.error('❌ ERROR:', message);
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Enter key support for email form
        document.getElementById('passwordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                emailSignUp();
            }
        });

        // Monitor authentication state
        auth.onAuthStateChanged((user) => {
            if (user) {
                console.log('👤 User signed in:', user.email || user.displayName);
                console.log('🆔 User ID:', user.uid);
                console.log('📧 Email verified:', user.emailVerified);
                
                // User is signed in, redirect to main platform
                if (!window.location.href.includes('redirecting')) {
                    showSuccess(`Signed in as ${user.displayName || user.email}! Redirecting to platform...`);
                    setTimeout(() => {
                        window.location.href = window.location.origin + '?user=' + user.uid;
                    }, 1000);
                }
            } else {
                console.log('👤 No user signed in');
            }
        });

        // Test Firebase connection
        function testFirebaseConnection() {
            console.log('🔬 Testing Firebase connection...');
            auth.currentUser ? 
                console.log('✅ Firebase connected - User:', auth.currentUser.email) : 
                console.log('✅ Firebase connected - No user signed in');
        }

        // Call test on page load
        setTimeout(testFirebaseConnection, 1000);

        console.log('🌟 Yogull Sign-Up Page Loaded');
        console.log('🔐 Firebase Authentication Ready');
        console.log('📧 Email/Password Sign-Up Available');
        console.log('🔗 Social Login: Google, Facebook, Twitter');
        console.log('🎯 Project ID: gohealme-9bdf0');
    </script>
</body>
</html>
